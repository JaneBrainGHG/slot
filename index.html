<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Epic Casino Slots</title>
    <link href="https://fonts.googleapis.com/css2?family=Wix+Madefor+Display:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(45deg, #1a0f3c, #2d1b4e);
            color: #fff;
            font-family: 'Wix Madefor Display', sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .main-slot {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
            margin-top: 120px;
        }

        .login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(8px);
        }

        .login-box {
            background: linear-gradient(180deg, #2a1f4d, #1a0f3c);
            padding: 40px;
            border-radius: 15px;
            border: 2px solid #8a2be2;
            width: 400px;
            box-shadow: 0 0 30px rgba(138, 43, 226, 0.5);
        }

        .login-box input {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #8a2be2;
            background: rgba(255,255,255,0.1);
            color: white;
            font-size: 16px;
        }

        .login-box button {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: none;
            background: linear-gradient(45deg, #8a2be2, #ff00ff);
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .slot-machine {
            background: linear-gradient(180deg, #2a1f4d, #1a0f3c);
            padding: 40px;
            border-radius: 15px;
            border: 2px solid #8a2be2;
            margin-top: 60px;
        }

        .slot-container {
            display: flex;
            gap: 25px;
            justify-content: center;
            margin: 40px 0;
        }

        .slot {
            width: 150px;
            height: 450px;
            border: 4px solid #ff00ff;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            background: #000;
        }

        .slot-strip {
            position: absolute;
            width: 100%;
            transition: transform 3s cubic-bezier(0.21, 0.53, 0.29, 0.99);
        }

        .slot-strip div {
            width: 100%;
            height: 150px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
            border: 2px solid #333;
        }

        .slot-strip img {
            width: 80%;
            height: 80%;
            object-fit: contain;
            max-width: 120px;
            max-height: 120px;
        }

        .controls {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
            padding: 30px;
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            margin-top: 40px;
        }

        .controls button, .user-info button, #spinButton {
            background: linear-gradient(45deg, #8a2be2, #ff00ff);
            padding: 15px 30px;
            border-radius: 8px;
            border: none;
            color: white;
            font-size: 16px;
            cursor: pointer;
            transition: transform 0.3s;
            box-shadow: 0 0 15px rgba(138, 43, 226, 0.3);
        }

        .controls button:hover, .user-info button:hover, #spinButton:hover {
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(138, 43, 226, 0.5);
        }

        #spinButton {
            font-size: 20px;
            font-weight: bold;
            padding: 20px 40px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .bet-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .bet-controls input {
            width: 100px;
            padding: 5px;
            text-align: center;
            background: rgba(255,255,255,0.1);
            border: 1px solid #8a2be2;
            border-radius: 5px;
            color: white;
            font-size: 16px;
        }

        .bet-controls button {
            padding: 10px 20px;
            font-size: 18px;
            font-weight: bold;
        }

        .info-box {
            background: rgba(0,0,0,0.5);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            min-width: 180px;
        }

        .user-info {
            background: linear-gradient(180deg, #2a1f4d, #1a0f3c);
            padding: 20px;
            border-radius: 15px;
            border: 2px solid #8a2be2;
            box-shadow: 0 0 30px rgba(138, 43, 226, 0.3);
        }

        .admin-panel {
            position: fixed;
            width: 300px;
            background: rgba(0,0,0,0.95);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #ff00ff;
            cursor: move;
            user-select: none;
            z-index: 1000;
            display: none;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .admin-panel-header {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            background: rgba(255,0,255,0.1);
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .admin-controls {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 5px;
        }

        .admin-input {
            width: 100%;
            padding: 8px;
            background: rgba(255,255,255,0.1);
            border: 1px solid #ff00ff;
            border-radius: 5px;
            color: white;
            font-size: 14px;
        }

        .admin-button {
            padding: 8px;
            background: linear-gradient(45deg, #ff00ff, #8a2be2);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 12px;
        }

        .admin-section {
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 10px;
            padding-top: 10px;
        }

        .win-chance-display {
            position: fixed;
            top: 30px;
            left: 30px;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 10px;
            font-size: 18px;
            color: #00ffff;
        }

        .money-rain {
            position: fixed;
            pointer-events: none;
            font-size: 40px;
            animation: moneyRain 3s linear forwards;
        }

        @keyframes moneyRain {
            0% { transform: translateY(-100vh) rotate(0deg); }
            100% { transform: translateY(100vh) rotate(720deg); }
        }

        .mega-win-animation {
            animation: megaWin 3s ease-in-out;
        }

        @keyframes megaWin {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
    </style>
</head>
<body>
    <div id="loginOverlay" class="login-overlay">
        <div class="login-box">
            <h2>Epic Casino Slots</h2>
            <input type="text" id="username" placeholder="Username" autocomplete="off">
            <input type="password" id="password" placeholder="Password">
            <button onclick="login()">Login</button>
            <button onclick="register()">Register</button>
        </div>
    </div>

    <div class="win-chance-display">
        Win Chance: <span id="winChanceDisplay">40</span>%
    </div>

    <div class="main-slot">
        <div class="user-info">
            <span id="userDisplay"></span>
            <button onclick="logout()">Logout</button>
        </div>

        <div class="slot-machine">
            <div class="slot-container">
                <div class="slot" id="slot1"></div>
                <div class="slot" id="slot2"></div>
                <div class="slot" id="slot3"></div>
                <div class="slot" id="slot4"></div>
            </div>
            
            <div class="controls">
                <div class="info-box">
                    <div class="info-label">Balance</div>
                    <div class="info-value" id="balance">1000.00</div>
                </div>
                
                <div class="info-box">
                    <div class="info-label">Bet</div>
                    <div class="bet-controls">
                        <button id="decreaseBet">-</button>
                        <input type="number" id="betAmount" value="10.00" min="10" step="1">
                        <button id="increaseBet">+</button>
                    </div>
                </div>
                
                <div class="info-box">
                    <div class="info-label">Win</div>
                    <div class="info-value" id="winAmount">0.00</div>
                </div>
                
                <button id="spinButton">SPIN</button>
            </div>
        </div>
    </div>

    <div class="admin-panel" id="adminPanel">
        <div class="admin-panel-header">
            <span>💠 Admin Controls</span>
            <div>
                <span class="minimize-btn" onclick="toggleAdminPanel()">_</span>
                <span class="close-btn" onclick="hideAdminPanel()">×</span>
            </div>
        </div>
        
        <div class="admin-controls">
            <div class="admin-section">
                <h4>Basic Controls</h4>
                <input type="number" class="admin-input" id="setBalance" placeholder="Balance">
                <button class="admin-button" onclick="setUserBalance()">Set Balance</button>
                
                <input type="number" class="admin-input" id="setWinChance" placeholder="Win % (0-100)">
                <button class="admin-button" onclick="setWinChance()">Set Win %</button>
                
                <input type="number" class="admin-input" id="setMultiplier" placeholder="Multiplier">
                <button class="admin-button" onclick="setMultiplier()">Set Multiplier</button>
            </div>

            <div class="admin-section">
                <h4>Advanced Controls</h4>
                <button class="admin-button" onclick="forceWin()">Force Win Next</button>
                <button class="admin-button" onclick="forceLose()">Force Lose Next</button>
                <button class="admin-button" onclick="toggleAutoSpin()">Toggle Auto Spin</button>
                <button class="admin-button" onclick="resetStats()">Reset Stats</button>
            </div>

            <div class="admin-section">
                <h4>Game Settings</h4>
                <input type="number" class="admin-input" id="minBet" placeholder="Min Bet">
                <input type="number" class="admin-input" id="maxBet" placeholder="Max Bet">
                <button class="admin-button" onclick="setBetLimits()">Set Bet Limits</button>
                <button class="admin-button" onclick="resetGame()">Reset Game</button>
            </div>

            <div class="admin-section">
                <h4>Statistics</h4>
                <div id="adminStats">
                    Total Spins: <span id="totalSpins">0</span><br>
                    Win Rate: <span id="winRate">0%</span><br>
                    Profit: <span id="totalProfit">0.00</span>
                </div>
            </div>
        </div>
    </div>

<script>
    const ADMIN_KEY = "7Hx9#mK2$pL5";
    
    const sounds = {
        spin: new Audio('./sounds/spin.mp3'),
        win: new Audio('./sounds/win.mp3'),
        megaWin: new Audio('./sounds/megawin.mp3'),
        lose: new Audio('./sounds/lose.mp3'),
        click: new Audio('./sounds/click.mp3'),
        login: new Audio('./sounds/login.mp3')
    };

    Object.values(sounds).forEach(sound => {
        sound.load();
        sound.volume = 0.5;
    });

    const symbols = [
        '<img src="./dist/img/slots/banana.png" alt="🍌" onerror="this.src=\'./dist/img/slots/default.png\'">',
        '<img src="./dist/img/slots/apple.png" alt="🍎" onerror="this.src=\'./dist/img/slots/default.png\'">',
        '<img src="./dist/img/slots/orange.png" alt="🍊" onerror="this.src=\'./dist/img/slots/default.png\'">',
        '<img src="./dist/img/slots/watermelon.png" alt="watermelon.png" alt="🍉" onerror="this.src=\'./dist/img/slots/default.png\'">'
    ];

    let multipliers = [150, 60, 30, 10];
    let isSpinning = false;
    let balance = 1000;
    let currentBet = 10;
    let forceNextWin = false;
    let forceNextLose = false;
    let isAutoSpinning = false;
    let gameStats = {
        totalSpins: 0,
        totalWins: 0,
        totalProfit: 0
    };

    const userSystem = {
        currentUser: null,
        users: JSON.parse(localStorage.getItem('casino_users')) || {},

        createAccount(username, password) {
            if (!this.users[username]) {
                this.users[username] = {
                    password,
                    balance: 1000,
                    isAdmin: false,
                    lastSpin: 0,
                    winChance: 40
                };
                this.saveUsers();
                return true;
            }
            return false;
        },

        login(username, password) {
            if (this.users[username]?.password === password) {
                this.currentUser = username;
                localStorage.setItem('current_user', username);
                return true;
            }
            return false;
        },

        logout() {
            this.currentUser = null;
            localStorage.removeItem('current_user');
            location.reload();
        },

        saveUsers() {
            localStorage.setItem('casino_users', JSON.stringify(this.users));
        },

        getBalance() {
            return this.users[this.currentUser]?.balance || 0;
        },

        updateBalance(amount) {
            if (this.currentUser) {
                this.users[this.currentUser].balance = amount;
                this.saveUsers();
            }
        }
    };

    function createSlotStrip(slotElement) {
        const strip = document.createElement('div');
        strip.className = 'slot-strip';
        
        for(let i = 0; i < 4; i++) {
            symbols.forEach(symbol => {
                const div = document.createElement('div');
                div.innerHTML = symbol;
                strip.appendChild(div);
            });
        }
        
        slotElement.appendChild(strip);
        return strip;
    }

    const slots = ['slot1', 'slot2', 'slot3', 'slot4'].map(id => {
        const slot = document.getElementById(id);
        return createSlotStrip(slot);
    });

    // Bet Controls - Freie Eingabe
document.getElementById('betAmount').addEventListener('input', (e) => {
    let newBet = parseFloat(e.target.value);
    
    if (!isNaN(newBet)) {
        // Nur Minimum-Grenze und Balance-Check
        if (newBet < 10) {
            newBet = 10;
        }
        if (newBet > balance) {
            newBet = balance;
        }
        
        currentBet = newBet;
        e.target.value = currentBet.toFixed(2);
    }
});

// Erlaubt Zahlen und Dezimalpunkt
document.getElementById('betAmount').addEventListener('keypress', (e) => {
    // Erlaubt alle Zahlen und einen Dezimalpunkt
    if (/[0-9.]/.test(e.key) && !(e.key === '.' && e.target.value.includes('.'))) {
        return true;
    }
    e.preventDefault();
});


    document.getElementById('increaseBet').addEventListener('click', () => {
        if (currentBet < balance) {
            currentBet += 10;
            document.getElementById('betAmount').value = currentBet.toFixed(2);
            sounds.click.play();
        }
    });

    document.getElementById('decreaseBet').addEventListener('click', () => {
        if (currentBet > 10) {
            currentBet -= 10;
            document.getElementById('betAmount').value = currentBet.toFixed(2);
            sounds.click.play();
        }
    });

    // Updated spin functionality
    document.getElementById('spinButton').addEventListener('click', () => {
        if (balance >= currentBet && !isSpinning) {
            spin();
        }
    });

    function spin() {
        if (isSpinning || balance < currentBet) return;
        
        gameStats.totalSpins++;
        const now = Date.now();
        const lastSpin = userSystem.users[userSystem.currentUser].lastSpin;
        const cooldown = 1000;

        if (now - lastSpin < cooldown) return;

        balance -= currentBet;
        updateBalance();
        
        userSystem.users[userSystem.currentUser].lastSpin = now;
        userSystem.saveUsers();
        
        sounds.spin.play();
        isSpinning = true;
        const results = [];
        
        slots.forEach((strip, index) => {
            strip.style.transition = 'none';
            strip.style.transform = 'translateY(0)';
            strip.offsetHeight;
            strip.style.transition = 'transform 3s cubic-bezier(0.21, 0.53, 0.29, 0.99)';
            
            let randomSymbol = Math.floor(Math.random() * symbols.length);
            
            if (forceNextWin && index < 3) {
                randomSymbol = 0;
            } else if (forceNextLose) {
                randomSymbol = Math.floor(Math.random() * symbols.length);
            }
            
            results.push(randomSymbol);
            
            const totalSpins = 2 + Math.random() * 2;
            const finalPosition = -(randomSymbol * 150 + (symbols.length * 150 * Math.floor(totalSpins)));
            
            strip.style.transform = `translateY(${finalPosition}px)`;
        });

        setTimeout(() => {
            isSpinning = false;
            checkWin(results);
            updateAdminStats();
        }, 3500);
    }

    function checkWin(results) {
        const winChance = userSystem.users[userSystem.currentUser].winChance;
        
        if (Math.random() * 100 < winChance || forceNextWin) {
            const randomSymbol = Math.floor(Math.random() * symbols.length);
            const matchCount = Math.random() < 0.5 ? 3 : 4;
            for(let i = 0; i < matchCount; i++) {
                results[i] = randomSymbol;
            }
        }

        let maxWin = 0;
        let matchingSymbols = 0;

        for(let i = 1; i < results.length; i++) {
            if(results[i] === results[0]) {
                matchingSymbols++;
            } else break;
        }

        if(matchingSymbols >= 2) {
            maxWin = currentBet * multipliers[results[0]] * (matchingSymbols / 4);
            gameStats.totalWins++;
        }

        if (maxWin > 0) {
            balance += maxWin;
            gameStats.totalProfit += maxWin;
            updateBalance();
            document.getElementById('winAmount').textContent = maxWin.toFixed(2);
            
            if (maxWin >= currentBet * 30) {
                sounds.megaWin.play();
                document.querySelector('.slot-machine').classList.add('mega-win-animation');
                createRainingMoney();
                setTimeout(() => {
                    document.querySelector('.slot-machine').classList.remove('mega-win-animation');
                }, 3000);
            } else {
                sounds.win.play();
            }
        } else {
            sounds.lose.play();
            document.getElementById('winAmount').textContent = '0.00';
            gameStats.totalProfit -= currentBet;
        }

        forceNextWin = false;
        forceNextLose = false;
    }

    function updateBalance() {
        document.getElementById('balance').textContent = balance.toFixed(2);
        userSystem.updateBalance(balance);
    }

    function updateWinChanceDisplay() {
        const winChance = userSystem.users[userSystem.currentUser].winChance;
        document.getElementById('winChanceDisplay').textContent = winChance;
    }

    // Admin functions remain the same
    function toggleAdminPanel() {
        const controls = adminPanel.querySelector('.admin-controls');
        controls.style.display = controls.style.display === 'none' ? 'grid' : 'none';
    }

    function hideAdminPanel() {
        adminPanel.style.display = 'none';
    }

    function showAdminControls() {
        document.getElementById('adminPanel').style.display = 'block';
    }

    function setUserBalance() {
        const newBalance = parseFloat(document.getElementById('setBalance').value);
        if (!isNaN(newBalance) && newBalance >= 0) {
            balance = newBalance;
            updateBalance();
            sounds.click.play();
        }
    }

    function setWinChance() {
        const newChance = parseFloat(document.getElementById('setWinChance').value);
        if (!isNaN(newChance) && newChance >= 0 && newChance <= 100) {
            userSystem.users[userSystem.currentUser].winChance = newChance;
            userSystem.saveUsers();
            updateWinChanceDisplay();
            sounds.click.play();
        }
    }

    function setMultiplier() {
        const newMultiplier = parseFloat(document.getElementById('setMultiplier').value);
        if (!isNaN(newMultiplier) && newMultiplier > 0) {
            multipliers = [newMultiplier * 15, newMultiplier * 6, newMultiplier * 3, newMultiplier];
            sounds.click.play();
        }
    }

    function forceWin() {
        forceNextWin = true;
        forceNextLose = false;
        sounds.click.play();
    }

    function forceLose() {
        forceNextLose = true;
        forceNextWin = false;
        sounds.click.play();
    }

    function toggleAutoSpin() {
        isAutoSpinning = !isAutoSpinning;
        if (isAutoSpinning) {
            autoSpin();
        }
    }

    function autoSpin() {
        if (isAutoSpinning && balance >= currentBet) {
            spin();
            setTimeout(autoSpin, 4000);
        }
    }

    function resetStats() {
        gameStats = {
            totalSpins: 0,
            totalWins: 0,
            totalProfit: 0
        };
        updateAdminStats();
        sounds.click.play();
    }

    function resetGame() {
        balance = 1000;
        currentBet = 10;
        updateBalance();
        document.getElementById('betAmount').value = currentBet.toFixed(2);
        document.getElementById('winAmount').textContent = '0.00';
        resetStats();
        sounds.click.play();
    }

    function updateAdminStats() {
        document.getElementById('totalSpins').textContent = gameStats.totalSpins;
        document.getElementById('winRate').textContent = 
            ((gameStats.totalWins / gameStats.totalSpins) * 100 || 0).toFixed(1) + '%';
        document.getElementById('totalProfit').textContent = gameStats.totalProfit.toFixed(2);
    }

    function createRainingMoney() {
        const emojis = ['💰', '💎', '🎰', '🏆', '💵'];
        for(let i = 0; i < 50; i++) {
            const money = document.createElement('div');
            money.className = 'money-rain';
            money.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
            money.style.left = Math.random() * 100 + 'vw';
            money.style.animationDuration = (2 + Math.random() * 2) + 's';
            document.body.appendChild(money);
            setTimeout(() => money.remove(), 3000);
        }
    }

    // Login functions
    function login() {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (userSystem.login(username, password)) {
            sounds.login.play();
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('userDisplay').textContent = `User: ${username}`;
            balance = userSystem.getBalance();
            updateBalance();
            updateWinChanceDisplay();
            if (userSystem.users[username].isAdmin) {
                showAdminControls();
            }
        } else {
            alert('Invalid credentials!');
        }
    }

    function register() {
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        
        if (userSystem.createAccount(username, password)) {
            sounds.click.play();
            alert('Account created! Please login.');
        } else {
            alert('Username already exists!');
        }
    }

    function logout() {
        sounds.click.play();
        userSystem.logout();
    }

    // Konami Code for admin panel
    let konamiCode = [];
    document.addEventListener('keydown', (e) => {
        konamiCode.push(e.key);
        konamiCode = konamiCode.slice(-10);
        if (konamiCode.join(',') === 'm') {
            document.getElementById('adminPanel').style.display = 'block';
            sounds.megaWin.play();
        }
    });

    // Check saved user on load
    const savedUser = localStorage.getItem('current_user');
    if (savedUser) {
        userSystem.currentUser = savedUser;
        document.getElementById('loginOverlay').style.display = 'none';
        document.getElementById('userDisplay').textContent = `User: ${savedUser}`;
        balance = userSystem.getBalance();
        updateBalance();
        updateWinChanceDisplay();
        if (userSystem.users[savedUser].isAdmin) {
            showAdminControls();
        }
    }

    // Admin key activation
document.addEventListener('keydown', (e) => {
    if (e.key === 'k') {
        const enteredKey = prompt('Enter admin key:');
        if (enteredKey === ADMIN_KEY) {
            document.getElementById('adminPanel').style.display = 'block';
            sounds.megaWin.play();
            // Make current user admin
            userSystem.users[userSystem.currentUser].isAdmin = true;
            userSystem.saveUsers();
        }
    }
});
</script>
</body>
</html>

